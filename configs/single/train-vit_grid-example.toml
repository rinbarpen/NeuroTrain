# ViT Grid example: fixed patch size, 2D spatial info, no CLS token.
# Use: uv run python main.py -c configs/single/train-vit_grid-example.toml --train

output_dir = "./runs"
task = "ImageCls"
entity = "Lab"
run_id = ""
device = "cuda"
seed = 42
classes = ["cifar10"]
metrics = ['accuracy', 'top1', 'top5']
postprocess = "classification"

[model]
name = "vit_grid"
pretrained = ""

[model.config]
variant = "base"
n_classes = 10
image_size = 224
patch_size = 16
channels = 3
input_sizes = [[3, 224, 224]]
dtypes = ["float32"]

[[criterion]]
type = "cross_entropy"
weight = 1.0
config = {}

[transform]
RESIZE = [224, 224]
PIL_TO_TENSOR = []
CONVERT_IMAGE_DTYPE = ['float32']
NORMALIZE = [false]

[dataset]
name = "cifar10"
root_dir = "./data/cifar10"
config = {}

[dataloader]
batch_size = 64
num_workers = 4
shuffle = true
pin_memory = true

[train]
batch_size = 64
epoch = 20
save_period = 0.25
save_recovery_period = 0.25
grad_accumulation_steps = 0

[train.optimizer]
type = "adamw"
learning_rate = 3e-4
weight_decay = 1e-4

[train.lr_scheduler]
type = "cosine"
warmup = 2
warmup_lr = 1e-5

[test]
batch_size = 128

[predict]
input = ""
[predict.config]

[private]
wandb = false
mode = 0

[private.log]
verbose = true
debug = false
